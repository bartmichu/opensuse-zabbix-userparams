<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.4</version>
    <date>2022-02-25T20:47:47Z</date>
    <groups>
        <group>
            <uuid>846977d1dfed4968bc5f8bdb363285bc</uuid>
            <name>Templates/Operating systems</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>1cfa73cfa1d340eab83163154ff5cf46</uuid>
            <template>Template opensuse-userparams by Zabbix agent active</template>
            <name>Template opensuse-userparams by Zabbix agent active</name>
            <description>OpenSUSE system monitoring.

Corresponding user parameters file and installation instructions can be found at https://github.com/bartmichu/opensuse-zabbix-userparams</description>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>417a73e6d2f6451b98f6f25e6bfb21c9</uuid>
                    <name>Reboot needed</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.needs-rebooting</key>
                    <delay>10m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Check if the reboot-needed flag was set by a previous update or install of a core library or service. This flag indicates that a system reboot is needed.

Expected return value:
1 - reboot is needed
2 - reboot is not needed.</description>
                    <valuemap>
                        <name>TruthValue</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <uuid>9be704bfc0a34a88b066834833830927</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.needs-rebooting)=1</expression>
                            <name>System reboot is needed</name>
                            <priority>WARNING</priority>
                            <description>The reboot-needed flag was set by a previous update or install of a core library or service. This flag indicates that reboot is required to ensure that your system benefits from these updates.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>697fd4f080f141a49ecbca095e674804</uuid>
                    <name>Patches - all</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.patches.all</key>
                    <delay>13m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Get the number of all applicable patches, including security patches. Requires sudo.

Expected return value:
number indicating the number of patches.</description>
                    <triggers>
                        <trigger>
                            <uuid>d8d0211e277f44a682413aeec160f482</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.patches.all)&gt;0</expression>
                            <name>Package patches are available: {ITEM.VALUE} patch[es]</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>beae4f68d7f44c71866c63534275225d</uuid>
                    <name>Patches - critical</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.patches.critical</key>
                    <delay>11m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Get the number of applicable critical patches. Requires sudo.

Expected return value:
number indicating the number of critical patches.</description>
                    <triggers>
                        <trigger>
                            <uuid>e6397de074a644ff91abf5394ce57ef7</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.patches.critical)&gt;0</expression>
                            <name>Critical patches pending: {ITEM.VALUE} patch[es]</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>65fea3dff5324a2581e756fb48352e47</uuid>
                    <name>Patches - interactive</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.patches.interactive</key>
                    <delay>14m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Get the number of applicable interactive patches. Patches are interactive when they need reboot, contain a message, or update a package whose license needs to be confirmed. Requires sudo.

Expected return value:
number indicating the number of interactive patches.</description>
                    <triggers>
                        <trigger>
                            <uuid>0defe39710b044ffb44e7884d97a1a92</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.patches.interactive)&gt;0</expression>
                            <name>Interactive patches pending: {ITEM.VALUE} patch[es]</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>892a426a8e4845f399a1661fcad122df</uuid>
                    <name>Patches - security</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.patches.security</key>
                    <delay>12m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Get the number of applicable security patches. Requires sudo.

Expected return value:
number indicating the number of security patches.</description>
                    <triggers>
                        <trigger>
                            <uuid>47f55e5d95ba419594d73932da3d09b2</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.patches.security)&gt;0</expression>
                            <name>Security patches pending: {ITEM.VALUE} patch[es]</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>835c7f611a5f4149a846e52ac638ca8a</uuid>
                    <name>Reboot requested</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.reboot-requested</key>
                    <delay>10m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Check if the system reboot is requested from reboot manager.
Requires rebootmgr and sudo.

Expected return value:
1 - reboot requested
2 - reboot not requested.</description>
                    <valuemap>
                        <name>TruthValue</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <uuid>ab485e4f6d554a918f8ca5e23c7d384b</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.reboot-requested)=1</expression>
                            <name>System reboot is requested</name>
                            <priority>WARNING</priority>
                            <description>System reboot is requested from reboot manager.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>a6d5f97c0d484be9a8212065173525e4</uuid>
                    <name>Services restart</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>opensuse-userparams.services.restart</key>
                    <delay>10m</delay>
                    <history>14d</history>
                    <trends>60d</trends>
                    <description>Get the number of services which are using meanwhile deleted files (e.g. shared libraries). These services may need to be restarted after an update. Requires sudo.

Expected return value:
number indicating the number of services.</description>
                    <triggers>
                        <trigger>
                            <uuid>30d077982bcd40f694a3f864737e70fd</uuid>
                            <expression>last(/Template opensuse-userparams by Zabbix agent active/opensuse-userparams.services.restart)&gt;0</expression>
                            <name>Some services need to be restarted: {ITEM.VALUE} service[s]</name>
                            <priority>INFO</priority>
                            <description>There are running services which still use files and libraries deleted or updated by recent upgrades. They should be restarted to benefit from the latest updates.</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <valuemaps>
                <valuemap>
                    <uuid>38f892ec8c254df080be4c093c7f676e</uuid>
                    <name>TruthValue</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>true</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>false</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
